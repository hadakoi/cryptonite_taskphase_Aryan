# SOAP

## Method

**Description:** The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?

Upon opening a website it seems like an info portal. when trying to append /etc/passwd to the end of the url we are not able to see anything and it shows an error.

Hence looking at the hint we know we have to use ``XML external entity Injection``.

XML External Entity (XXE) injection is a security vulnerability that happens when an application improperly processes XML data.

XML is a language used for structuring data, and sometimes applications let users submit XML data directly in this case whene we are trying to select one of the 3 options 
to see the details for it.

If the application doesn’t handle XML carefully, it can be tricked into loading external files.

XXE is essentially a cleverly crafted line of XML code that’s designed to make the server read a file or perform an action it normally shouldn’t.

we can use the repeater tab here to use multiple requests without having to go back and forth to our browser.

When interacting with the website and selecting different information areas the XML structure changes based on the ID selected. This is what the xml Response looks like.

```xml
<?xml version="1.0" encoding="UTF-8"?> 
<data>
    <ID>
        1
    </ID>
</data>
```

1. **XML Declaration**:
   - `<?xml version="1.0" encoding="UTF-8"?>`
     - `version="1.0"` specifies the XML version in use (1.0 is the standard).
     - `encoding="UTF-8"` specifies the character encoding (UTF-8 is commonly used and widely supported).

2. **Root Element (`<data>`)**:
   - `<data>` is the root element that encloses all other elements within the XML document. Every XML document has a single root element.

3. **Child Element (`<ID>`)**:
   - `<ID>` is a child element inside `<data>`.
   - The ID value changes dynamically based on the selected information area, with IDs such as `1` or `2` representing different sections or data items on the website.


---

This XML is most likely used for allowing user to change between the 3 details.

Changing the data Item to 2 for eg prints the 2nd option.

Upon looking back at the hint we can see ``XML external entity Injection``

**NOTE:**

Searching this up we come this link

https://portswigger.net/web-security/xxe

XML External Entity (XXE) injection is a security vulnerability that happens when an application improperly processes XML data.

XML is a language used for structuring data, and sometimes applications let users submit XML data directly in this case whene we are trying to select one of the 3 options 
to see the details for it.

If the application doesn’t handle XML carefully, it can be tricked into loading external files.

XXE is essentially a cleverly crafted line of XML code that’s designed to make the server read a file or perform an action it normally shouldn’t.

---

From the website we can understand that we can exploit XML using an ``XML external entity`` injection to retrieve files we can include this: 

![image](https://github.com/user-attachments/assets/b935ffe5-c9cb-4db0-8e46-d5f51295148b)

this  ``<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>``  allows us to point to the file we want to exploit.

It essentially creates an entity named xxe that points to the ``/etc/password`` file on the web server.

As that is the file we need to access the file we need to accesss is the same as shown in the command.

We can then pass an XEE payload such as This XXE payload defines an external entity &xxe;. We add this in the <ID> section of the website header.
By including ``&xxe;`` within the XML, we’re asking the server to replace &xxe; with the actual contents of /etc/passwd

![image](https://github.com/user-attachments/assets/17a7e23c-3850-480b-bf45-58d242fdc0d7)


## Flag

> picoCTF{XML_3xtern@l_3nt1t1ty_4dbeb2ed}












