# SOAP

## Method

**Hint:** The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?

Upon opening a website it seems like an info portal. when trying to append /etc/passwd to the end of the url we are not able to see anything and it shows an error.

Hence looking at the hint we know we have to use XML external entity Injection.
As they have asked us to read the /etc/passwd file we need to explot XXE to retrieve files.

XML External Entity (XXE) injection is a security vulnerability that happens when an application improperly processes XML data.

XML is a language used for structuring data, and sometimes applications let users submit XML data directly in this case whene we are trying to select one of the 3 options 
to see the details for it.

If the application doesn’t handle XML carefully, it can be tricked into loading external files.

XXE is essentially a cleverly crafted line of XML code that’s designed to make the server read a file or perform an action it normally shouldn’t.

we can use the repeater tab here to use multiple requests without having to go back and forth to our browser.

Looking through the website on burpsuite and trying to load the details section for either 3 options we can see this line of code below our requests.

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
<ID>
  1
</ID>
</data>
```

**WHAT THIS ALL MEANS:**
<?xml ... ?> is the XML declaration.
version="1.0" specifies the XML version being used (1.0 is the most common version).
encoding="UTF-8" specifies that the text is encoded in UTF-8, which is a standard character encoding.

Root Element (<data> ... </data>):
<data> and </data> mark the beginning and end of the root element. This root element is called data.
In XML, the root element wraps all the other elements. In this case, everything in the document is enclosed within <data>.

Child Element (<ID>1</ID>):
<ID> ... </ID> is a child element inside the data element.
The element ID contains the value 1.

---


This most likely signifies one out of the 3 data items and this is what the xml is for allowing user to change between the 3 details.

Changing the data Item to 2 for eg prints the 2nd option.

https://portswigger.net/web-security/xxe

From the website we can exploit XML using an ``XML external entity`` injection
 to retrieve files we can include this

![image](https://github.com/user-attachments/assets/b935ffe5-c9cb-4db0-8e46-d5f51295148b)

this for example ``<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>`` which allows us to point to the file we want to exploit
As that is the file we need to access.

We can then pass an XEE payload such as This XXE payload defines an external entity &xxe;. We add this in the <ID> section of the website header.
By including ``&xxe;`` within the XML, we’re asking the server to replace &xxe; with the actual contents of /etc/passwd

![image](https://github.com/user-attachments/assets/17a7e23c-3850-480b-bf45-58d242fdc0d7)


## Flag

> picoCTF{XML_3xtern@l_3nt1t1ty_4dbeb2ed}












