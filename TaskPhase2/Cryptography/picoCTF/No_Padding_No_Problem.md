# No Padding, No Problem

## Method

```
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with nc mercury.picoctf.net 33780.
```

**Hint1:**What can you do with a different pair of ciphertext and plaintext? What if it is not so different after all...

Upon loading upp the challenge we are greeted with this:

```
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 138661185835870130309111681514345541650618981398365747884600497390772137181312767710651641344739401947353989083486627013836678640300635234794372505059778318726876693108860487299128088101675594659501013858202757339382756219719344169056351749600075287025422967877928525370085578843324942195406564118958016368879
e: 65537
ciphertext: 117584824859952003847887046546007553712795948623393267462895150228888834068926838119020316735836295863184877953371147373744421226229940570901770261470583247147696367277783606003534054866341257307731733700814217437076481500533626671224626868608281022484623928838708567750826527066128937976288809936218771312854

Give me ciphertext to decrypt: 117584824859952003847887046546007553712795948623393267462895150228888834068926838119020316735836295863184877953371147373744421226229940570901770261470583247147696367277783606003534054866341257307731733700814217437076481500533626671224626868608281022484623928838708567750826527066128937976288809936218771312854
Will not decrypt the ciphertext. Try Again
```

It seems to ask for ciphertext to decrypt. Now if this ciphertext was the one we where provided with it will not decrypt it manually. 

When no padding encryption occurs we understand that it is homophoric a form of encryption that allows computations to be performed on encrypted data without first having to decrypt it. The resulting computations are left in an encrypted form which, when decrypted, result in an output that is identical to that produced had the operations been performed on the unencrypted data.

What this essentially means is we can apply mathamatical operations on the cipher text and the result will be an encrypted form of the result of those operations. And to reverse it just undo the mathamatical operation.

**For e.g For example, if we multiply the original ciphertext by the ciphertext of 2 and then decrypt it, the result will contain both the initial value of the ciphertext and the number 2. However, by dividing the decrypted result by 2, we retrieve the original ciphertext.**

Now they seem to have given us n, e So lets encrypt 2 and multiply it by the ct they gave.

c = pow(2, e, n)

Then we multiply c and ct given to us.

Next we just decrypt it using the oracle. 

After that we can just divide by 2

Then decrypt normally by first converting to hex string which is then made into a byte array where it is then decoded.


```python
n= 75927450808333138071370023576078544588405770626261972571637769385881787426590740881678265223915448832997305597368061459185643300453360802625661853358136975463704243116014896372087901254784123189200570262013232002078562791103743496439229249552690293249609557218047940032121879684171031700999599129198447530101
e= 65537
ciphertext= 6581440270916573094427174183283957706606316112304682534577782991016634456337533641790663606422273571313484838073547244385118974800534319083195809032947917096824244466455059216635094108085197985191424812956909557985431254527000896056731347601571236298924794120037322747430288435588713449439442948842414786510
c2 = pow(2, e, n)

ciphertext = c2 * ciphertext

print(ciphertext)

###
decrypt = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890768709712035489670906

decrypt = decrypt // 2

print("\n")

print(bytearray.fromhex(format(decrypt, 'x')).decode())
```

```
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 75927450808333138071370023576078544588405770626261972571637769385881787426590740881678265223915448832997305597368061459185643300453360802625661853358136975463704243116014896372087901254784123189200570262013232002078562791103743496439229249552690293249609557218047940032121879684171031700999599129198447530101
e: 65537
ciphertext: 6581440270916573094427174183283957706606316112304682534577782991016634456337533641790663606422273571313484838073547244385118974800534319083195809032947917096824244466455059216635094108085197985191424812956909557985431254527000896056731347601571236298924794120037322747430288435588713449439442948842414786510


Give me ciphertext to decrypt: 3999138092088920265932817364309457566483049086997729410929319718428385666844899476676077782372808400005877425356079400086121041041201671128732250449555998140120573777850803831045493274512227683618497644827620917978449652328199428537273686240054546294715913304722189828899556379896381700104579793434469933318935408497179219175366970457308773547603315301141967429850311195752720273018548172008989367322744034401430794536544343133229905794074587309907447160984905248180516293197472794873952158735483337692338238260446600009144410590046901365262479705028108401412205222352442365250953681000765540759235125121467972910
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890768709712035489670906
```

Output of the code 

```
3999138092088920265932817364309457566483049086997729410929319718428385666844899476676077782372808400005877425356079400086121041041201671128732250449555998140120573777850803831045493274512227683618497644827620917978449652328199428537273686240054546294715913304722189828899556379896381700104579793434469933318935408497179219175366970457308773547603315301141967429850311195752720273018548172008989367322744034401430794536544343133229905794074587309907447160984905248180516293197472794873952158735483337692338238260446600009144410590046901365262479705028108401412205222352442365250953681000765540759235125121467972910


picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_0801973}
```

## 

> picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_0801973}